{"version":3,"file":"design-tokens-CutdDvcS.js","sources":["../node_modules/@fynmesh/kernel/lib/use-middleware.js","../src/middleware/design-tokens.ts"],"sourcesContent":["/**\n * mark some user code for middleware usage\n *\n * @param meta Information about the middleware\n * @param config Configuration for the middleware\n * @param user User code that uses the middleware\n * @returns A middleware usage object\n */\nexport const useMiddleware = (meta, user) => {\n    user.__middlewareMeta = [].concat(meta);\n    return user;\n};\nexport const noOpMiddlewareUser = {\n    initialize: () => { },\n    execute: () => { },\n};\n// example usage of useMiddleware\nexport const main = useMiddleware({\n    info: {\n        name: \"react-context\",\n        version: \"^1.0.0\",\n        provider: \"fynapp-react-lib\",\n    },\n    config: { theme: \"light\" },\n}, noOpMiddlewareUser);\n//# sourceMappingURL=use-middleware.js.map","import type { FynApp, FynAppMiddleware, FynAppMiddlewareCallContext } from \"@fynmesh/kernel\";\nimport { useMiddleware, noOpMiddlewareUser } from \"@fynmesh/kernel\";\nimport type {\n    DesignTokensData,\n    ThemeConfig,\n    DesignTokensMiddlewareConfig,\n    DesignTokensAPI\n} from \"../types\";\n\n// =============================================================================\n// Default Themes\n// =============================================================================\n\nconst defaultTokens: DesignTokensData = {\n    colors: {\n        primary: '#2563eb',\n        secondary: '#64748b',\n        success: '#059669',\n        warning: '#d97706',\n        danger: '#dc2626',\n        info: '#0284c7',\n        light: '#f8fafc',\n        dark: '#0f172a',\n        // FynApp specific colors\n        fynapp1: '#6366f1',\n        fynapp1b: '#10b981',\n        fynapp2: '#8b5cf6',\n        fynapp3: '#ff5733',\n        fynapp4: '#42b883',\n        fynapp5: '#673ab8',\n        fynapp6: '#4f46e5',\n        fynapp7: '#2D7FF9',\n    },\n    spacing: {\n        xs: '0.25rem',\n        sm: '0.5rem',\n        md: '1rem',\n        lg: '1.5rem',\n        xl: '2rem',\n        '2xl': '2.5rem',\n        '3xl': '3rem',\n    },\n    typography: {\n        sizes: {\n            xs: '0.75rem',\n            sm: '0.875rem',\n            base: '1rem',\n            lg: '1.125rem',\n            xl: '1.25rem',\n            '2xl': '1.5rem',\n            '3xl': '1.875rem',\n            '4xl': '2.25rem',\n            '5xl': '3rem',\n            '6xl': '3.75rem',\n        },\n        weights: {\n            thin: 100,\n            light: 300,\n            normal: 400,\n            medium: 500,\n            semibold: 600,\n            bold: 700,\n            extrabold: 800,\n            black: 900,\n        },\n        families: {\n            sans: 'ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", sans-serif',\n            serif: 'ui-serif, Georgia, Cambria, \"Times New Roman\", Times, serif',\n            mono: 'ui-monospace, SFMono-Regular, \"SF Mono\", Consolas, \"Liberation Mono\", Menlo, monospace',\n        },\n    },\n    shadows: {\n        sm: '0 1px 2px 0 rgb(0 0 0 / 0.05)',\n        md: '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)',\n        lg: '0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)',\n        xl: '0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1)',\n        '2xl': '0 25px 50px -12px rgb(0 0 0 / 0.25)',\n        inner: 'inset 0 2px 4px 0 rgb(0 0 0 / 0.05)',\n        none: '0 0 #0000',\n    },\n    borders: {\n        radius: {\n            none: '0px',\n            sm: '0.125rem',\n            md: '0.375rem',\n            lg: '0.5rem',\n            xl: '0.75rem',\n            '2xl': '1rem',\n            '3xl': '1.5rem',\n            full: '9999px',\n        },\n        width: {\n            0: '0px',\n            1: '1px',\n            2: '2px',\n            4: '4px',\n            8: '8px',\n        },\n    },\n    breakpoints: {\n        sm: '640px',\n        md: '768px',\n        lg: '1024px',\n        xl: '1280px',\n        '2xl': '1536px',\n    },\n};\n\nconst predefinedThemes: Record<string, ThemeConfig> = {\n    'fynmesh-default': {\n        name: 'FynMesh Default',\n        tokens: defaultTokens,\n        cssCustomProperties: true,\n        cssVariablePrefix: 'fynmesh',\n    },\n    'fynmesh-dark': {\n        name: 'FynMesh Dark',\n        tokens: {\n            ...defaultTokens,\n            colors: {\n                ...defaultTokens.colors,\n                primary: '#3b82f6',\n                secondary: '#6b7280',\n                success: '#10b981',\n                warning: '#f59e0b',\n                danger: '#ef4444',\n                info: '#06b6d4',\n                light: '#1e293b',\n                dark: '#f1f5f9',\n                fynapp1: '#7c3aed',\n                fynapp1b: '#059669',\n                fynapp2: '#a855f7',\n                fynapp3: '#e11d48',\n                fynapp4: '#059669',\n                fynapp5: '#8b5cf6',\n                fynapp6: '#6366f1',\n                fynapp7: '#0ea5e9',\n            },\n        },\n        cssCustomProperties: true,\n        cssVariablePrefix: 'fynmesh',\n    },\n    'fynmesh-blue': {\n        name: 'FynMesh Blue',\n        tokens: {\n            ...defaultTokens,\n            colors: {\n                ...defaultTokens.colors,\n                primary: '#1e40af',\n                secondary: '#3b82f6',\n                success: '#059669',\n                warning: '#d97706',\n                danger: '#dc2626',\n                info: '#0284c7',\n                light: '#eff6ff',\n                dark: '#1e3a8a',\n                fynapp1: '#1e40af',\n                fynapp1b: '#3b82f6',\n                fynapp2: '#6366f1',\n                fynapp3: '#0ea5e9',\n                fynapp4: '#06b6d4',\n                fynapp5: '#8b5cf6',\n                fynapp6: '#1e40af',\n                fynapp7: '#0284c7',\n            },\n        },\n        cssCustomProperties: true,\n        cssVariablePrefix: 'fynmesh',\n    },\n    'fynmesh-green': {\n        name: 'FynMesh Green',\n        tokens: {\n            ...defaultTokens,\n            colors: {\n                ...defaultTokens.colors,\n                primary: '#059669',\n                secondary: '#10b981',\n                success: '#22c55e',\n                warning: '#eab308',\n                danger: '#ef4444',\n                info: '#06b6d4',\n                light: '#f0fdf4',\n                dark: '#064e3b',\n                fynapp1: '#059669',\n                fynapp1b: '#10b981',\n                fynapp2: '#22c55e',\n                fynapp3: '#84cc16',\n                fynapp4: '#65a30d',\n                fynapp5: '#16a34a',\n                fynapp6: '#059669',\n                fynapp7: '#0d9488',\n            },\n        },\n        cssCustomProperties: true,\n        cssVariablePrefix: 'fynmesh',\n    },\n    'fynmesh-purple': {\n        name: 'FynMesh Purple',\n        tokens: {\n            ...defaultTokens,\n            colors: {\n                ...defaultTokens.colors,\n                primary: '#7c3aed',\n                secondary: '#8b5cf6',\n                success: '#10b981',\n                warning: '#f59e0b',\n                danger: '#ef4444',\n                info: '#06b6d4',\n                light: '#faf5ff',\n                dark: '#581c87',\n                fynapp1: '#7c3aed',\n                fynapp1b: '#8b5cf6',\n                fynapp2: '#a855f7',\n                fynapp3: '#c084fc',\n                fynapp4: '#d8b4fe',\n                fynapp5: '#9333ea',\n                fynapp6: '#7c3aed',\n                fynapp7: '#6d28d9',\n            },\n        },\n        cssCustomProperties: true,\n        cssVariablePrefix: 'fynmesh',\n    },\n    'fynmesh-sunset': {\n        name: 'FynMesh Sunset',\n        tokens: {\n            ...defaultTokens,\n            colors: {\n                ...defaultTokens.colors,\n                primary: '#ea580c',\n                secondary: '#f97316',\n                success: '#10b981',\n                warning: '#eab308',\n                danger: '#ef4444',\n                info: '#06b6d4',\n                light: '#fff7ed',\n                dark: '#7c2d12',\n                fynapp1: '#ea580c',\n                fynapp1b: '#f97316',\n                fynapp2: '#fb923c',\n                fynapp3: '#fed7aa',\n                fynapp4: '#fdba74',\n                fynapp5: '#dc2626',\n                fynapp6: '#ea580c',\n                fynapp7: '#c2410c',\n            },\n        },\n        cssCustomProperties: true,\n        cssVariablePrefix: 'fynmesh',\n    },\n    'fynmesh-cyberpunk': {\n        name: 'FynMesh Cyberpunk',\n        tokens: {\n            ...defaultTokens,\n            colors: {\n                ...defaultTokens.colors,\n                primary: '#00ff88',\n                secondary: '#ff0080',\n                success: '#00ff88',\n                warning: '#ffff00',\n                danger: '#ff0040',\n                info: '#00ddff',\n                light: '#0a0a0a',\n                dark: '#00ff88',\n                fynapp1: '#00ff88',\n                fynapp1b: '#ff0080',\n                fynapp2: '#8000ff',\n                fynapp3: '#ff0040',\n                fynapp4: '#00ddff',\n                fynapp5: '#ff8000',\n                fynapp6: '#00ff88',\n                fynapp7: '#4080ff',\n            },\n        },\n        cssCustomProperties: true,\n        cssVariablePrefix: 'fynmesh',\n    },\n};\n\n// =============================================================================\n// Design Tokens Core Class\n// =============================================================================\n\nexport class DesignTokens {\n    private globalTheme: string = 'fynmesh-default';\n    private perFynAppThemes = new Map<string, string>(); // fynAppName -> theme\n    private globalOptIns = new Map<string, boolean>(); // fynAppName -> whether it opts into global changes\n    private customThemes = new Map<string, ThemeConfig>();\n    private themeChangeSubscribers = new Set<(theme: string, tokens: DesignTokensData, fynAppName?: string) => void>();\n    private styleElements = new Map<string, HTMLStyleElement>();\n    private fynAppConfigs = new Map<string, { prefix: string; isGlobal: boolean; isComponentLibrary: boolean }>();\n\n    constructor() {\n        // Initialize with predefined themes\n        Object.entries(predefinedThemes).forEach(([key, theme]) => {\n            this.customThemes.set(key, theme);\n        });\n\n        // Load persisted theme\n        this.loadPersistedTheme();\n    }\n\n    public getTokens(fynAppName?: string): DesignTokensData {\n        const themeToUse = fynAppName && this.perFynAppThemes.has(fynAppName)\n            ? this.perFynAppThemes.get(fynAppName)!\n            : this.globalTheme;\n        const theme = this.customThemes.get(themeToUse);\n        return theme?.tokens || defaultTokens;\n    }\n\n    public getTheme(fynAppName?: string): string {\n        if (fynAppName) {\n            // If app has a specific theme, use that\n            if (this.perFynAppThemes.has(fynAppName)) {\n                return this.perFynAppThemes.get(fynAppName)!;\n            }\n            // If app has opted into global and no specific theme, use global\n            if (this.globalOptIns.get(fynAppName)) {\n                return this.globalTheme;\n            }\n            // Otherwise, use the app's initial theme or default\n            return this.globalTheme; // fallback to global theme\n        }\n        return this.globalTheme;\n    }\n\n    public setTheme(themeName: string, fynAppName?: string, applyGlobally: boolean = true): void {\n        if (!this.customThemes.has(themeName)) {\n            console.warn(`🚨 Theme \"${themeName}\" not found. Available themes:`, Array.from(this.customThemes.keys()));\n            return;\n        }\n\n        if (applyGlobally || !fynAppName) {\n            // Apply globally, but only to apps that have opted in\n            this.globalTheme = themeName;\n\n            // Clear per-app themes only for apps that have opted into global changes\n            const appsToUpdate: string[] = [];\n            this.globalOptIns.forEach((optedIn, appName) => {\n                if (optedIn) {\n                    this.perFynAppThemes.delete(appName); // Remove specific theme, will use global\n                    appsToUpdate.push(appName);\n                }\n            });\n\n            // Update CSS for opted-in apps\n            appsToUpdate.forEach(appName => this.updateFynAppCSSCustomProperties(appName));\n\n            // Notify subscribers for opted-in apps\n            appsToUpdate.forEach(appName => {\n                const tokens = this.getTokens(appName);\n                this.themeChangeSubscribers.forEach(callback => {\n                    try {\n                        callback(themeName, tokens);\n                    } catch (error) {\n                        console.error('Error in theme change callback:', error);\n                    }\n                });\n            });\n        } else {\n            // Apply to specific fynapp only\n            this.perFynAppThemes.set(fynAppName, themeName);\n            this.updateFynAppCSSCustomProperties(fynAppName);\n\n            // Notify subscribers for this specific fynapp\n            const tokens = this.getTokens(fynAppName);\n            this.themeChangeSubscribers.forEach(callback => {\n                try {\n                    callback(themeName, tokens, fynAppName);\n                } catch (error) {\n                    console.error('Error in theme change callback:', error);\n                }\n            });\n        }\n\n        // Persist theme\n        this.persistTheme();\n\n        console.debug(`🎨 Theme changed to: ${themeName}${fynAppName && !applyGlobally ? ` for ${fynAppName}` : ' globally'}`);\n    }\n\n    public registerTheme(theme: ThemeConfig): void {\n        this.customThemes.set(theme.name, theme);\n        console.debug(`🎨 Registered theme: ${theme.name}`);\n    }\n\n    public setGlobalOptIn(fynAppName: string, optIn: boolean): void {\n        this.globalOptIns.set(fynAppName, optIn);\n        this.persistGlobalOptIns();\n        console.debug(`🎨 ${fynAppName} ${optIn ? 'opted into' : 'opted out of'} global theme changes`);\n    }\n\n    public getGlobalOptIn(fynAppName: string): boolean {\n        return this.globalOptIns.get(fynAppName) || false;\n    }\n\n    public getCSSVariable(tokenPath: string, prefix: string = 'fynmesh'): string {\n        return `var(--${prefix}-${tokenPath})`;\n    }\n\n    public subscribeToThemeChanges(callback: (theme: string, tokens: DesignTokensData) => void): () => void {\n        this.themeChangeSubscribers.add(callback);\n        return () => this.themeChangeSubscribers.delete(callback);\n    }\n\n    public injectCustomCSS(css: string, id: string): void {\n        let styleElement = document.getElementById(id) as HTMLStyleElement;\n\n        if (!styleElement) {\n            styleElement = document.createElement('style');\n            styleElement.id = id;\n            document.head.appendChild(styleElement);\n        }\n\n        styleElement.textContent = css;\n    }\n\n    public injectCSSCustomProperties(fynAppName: string, prefix: string = 'fynmesh', isGlobal: boolean = false): void {\n        const tokens = this.getTokens();\n        const scope = isGlobal ? ':root' : `#${fynAppName}`;\n        const css = this.generateCSSCustomProperties(tokens, prefix, scope);\n\n        const styleId = `fynmesh-design-tokens-${fynAppName}`;\n        let styleElement = document.getElementById(styleId) as HTMLStyleElement;\n\n        if (!styleElement) {\n            styleElement = document.createElement('style');\n            styleElement.id = styleId;\n            document.head.appendChild(styleElement);\n            this.styleElements.set(styleId, styleElement);\n        }\n\n        styleElement.textContent = css;\n\n        // Store the configuration for this fynapp\n        this.fynAppConfigs.set(fynAppName, { prefix, isGlobal, isComponentLibrary: false });\n    }\n\n    public injectCSSForComponentLibrary(fynAppName: string, prefix: string = 'fynmesh'): void {\n        const tokens = this.getTokens();\n        // Generate CSS for both the component library's own scope AND for importing apps\n        const ownScope = `#${fynAppName}`;\n        const importingAppScope = `[data-fynapp-components=\"${fynAppName}\"]`; // For importing apps to use\n\n        const css = [\n            this.generateCSSCustomProperties(tokens, prefix, ownScope),\n            this.generateCSSCustomProperties(tokens, prefix, importingAppScope)\n        ].join('\\n\\n');\n\n        const styleId = `fynmesh-design-tokens-${fynAppName}`;\n        let styleElement = document.getElementById(styleId) as HTMLStyleElement;\n\n        if (!styleElement) {\n            styleElement = document.createElement('style');\n            styleElement.id = styleId;\n            document.head.appendChild(styleElement);\n            this.styleElements.set(styleId, styleElement);\n        }\n\n        styleElement.textContent = css;\n\n        // Store the configuration for this fynapp\n        this.fynAppConfigs.set(fynAppName, { prefix, isGlobal: false, isComponentLibrary: true });\n    }\n\n    private generateCSSCustomProperties(tokens: DesignTokensData, prefix: string, scope: string = ':root'): string {\n        const lines: string[] = [`${scope} {`];\n\n        // Colors\n        Object.entries(tokens.colors).forEach(([key, value]) => {\n            lines.push(`  --${prefix}-color-${key}: ${value};`);\n        });\n\n        // Spacing\n        Object.entries(tokens.spacing).forEach(([key, value]) => {\n            lines.push(`  --${prefix}-spacing-${key}: ${value};`);\n        });\n\n        // Typography\n        Object.entries(tokens.typography.sizes).forEach(([key, value]) => {\n            lines.push(`  --${prefix}-text-${key}: ${value};`);\n        });\n\n        Object.entries(tokens.typography.weights).forEach(([key, value]) => {\n            lines.push(`  --${prefix}-font-weight-${key}: ${value};`);\n        });\n\n        Object.entries(tokens.typography.families).forEach(([key, value]) => {\n            lines.push(`  --${prefix}-font-family-${key}: ${value};`);\n        });\n\n        // Shadows\n        Object.entries(tokens.shadows).forEach(([key, value]) => {\n            lines.push(`  --${prefix}-shadow-${key}: ${value};`);\n        });\n\n        // Borders\n        Object.entries(tokens.borders.radius).forEach(([key, value]) => {\n            lines.push(`  --${prefix}-radius-${key}: ${value};`);\n        });\n\n        Object.entries(tokens.borders.width).forEach(([key, value]) => {\n            lines.push(`  --${prefix}-border-${key}: ${value};`);\n        });\n\n        // Breakpoints\n        Object.entries(tokens.breakpoints).forEach(([key, value]) => {\n            lines.push(`  --${prefix}-breakpoint-${key}: ${value};`);\n        });\n\n        lines.push('}');\n\n        return lines.join('\\n');\n    }\n\n    private updateAllCSSCustomProperties(): void {\n        this.styleElements.forEach((styleElement, styleId) => {\n            const fynAppName = styleId.replace('fynmesh-design-tokens-', '');\n            const config = this.fynAppConfigs.get(fynAppName);\n\n            if (config) {\n                const tokens = this.getTokens(fynAppName);\n                const scope = config.isGlobal ? ':root' : `#${fynAppName}`;\n                const css = this.generateCSSCustomProperties(tokens, config.prefix, scope);\n                styleElement.textContent = css;\n            }\n        });\n    }\n\n    private updateFynAppCSSCustomProperties(fynAppName: string): void {\n        const styleId = `fynmesh-design-tokens-${fynAppName}`;\n        const styleElement = this.styleElements.get(styleId);\n        const config = this.fynAppConfigs.get(fynAppName);\n\n        if (styleElement && config) {\n            const tokens = this.getTokens(fynAppName);\n\n            if (config.isComponentLibrary) {\n                // For component libraries, generate CSS for both own scope and importing apps\n                const ownScope = `#${fynAppName}`;\n                const importingAppScope = `[data-fynapp-components=\"${fynAppName}\"]`;\n\n                const css = [\n                    this.generateCSSCustomProperties(tokens, config.prefix, ownScope),\n                    this.generateCSSCustomProperties(tokens, config.prefix, importingAppScope)\n                ].join('\\n\\n');\n\n                styleElement.textContent = css;\n            } else {\n                // Regular apps use single scope\n                const scope = config.isGlobal ? ':root' : `#${fynAppName}`;\n                const css = this.generateCSSCustomProperties(tokens, config.prefix, scope);\n                styleElement.textContent = css;\n            }\n        }\n    }\n\n    private loadPersistedTheme(): void {\n        try {\n            if (typeof window !== 'undefined' && window.localStorage) {\n                const saved = localStorage.getItem('fynmesh-theme');\n                if (saved && this.customThemes.has(saved)) {\n                    this.globalTheme = saved;\n                }\n\n                // Load per-fynapp themes\n                const perAppThemes = localStorage.getItem('fynmesh-per-app-themes');\n                if (perAppThemes) {\n                    const parsed = JSON.parse(perAppThemes);\n                    Object.entries(parsed).forEach(([fynAppName, theme]) => {\n                        if (typeof theme === 'string' && this.customThemes.has(theme)) {\n                            this.perFynAppThemes.set(fynAppName, theme);\n                        }\n                    });\n                }\n\n                // Load global opt-ins\n                const globalOptIns = localStorage.getItem('fynmesh-global-opt-ins');\n                if (globalOptIns) {\n                    const parsed = JSON.parse(globalOptIns);\n                    Object.entries(parsed).forEach(([fynAppName, optIn]) => {\n                        if (typeof optIn === 'boolean') {\n                            this.globalOptIns.set(fynAppName, optIn);\n                        }\n                    });\n                }\n            }\n        } catch (error) {\n            console.warn('Failed to load persisted theme:', error);\n        }\n    }\n\n    private persistTheme(): void {\n        try {\n            if (typeof window !== 'undefined' && window.localStorage) {\n                localStorage.setItem('fynmesh-theme', this.globalTheme);\n\n                // Persist per-fynapp themes\n                const perAppThemes = Object.fromEntries(this.perFynAppThemes.entries());\n                localStorage.setItem('fynmesh-per-app-themes', JSON.stringify(perAppThemes));\n            }\n        } catch (error) {\n            console.warn('Failed to persist theme:', error);\n        }\n    }\n\n    private persistGlobalOptIns(): void {\n        try {\n            if (typeof window !== 'undefined' && window.localStorage) {\n                const globalOptIns = Object.fromEntries(this.globalOptIns.entries());\n                localStorage.setItem('fynmesh-global-opt-ins', JSON.stringify(globalOptIns));\n            }\n        } catch (error) {\n            console.warn('Failed to persist global opt-ins:', error);\n        }\n    }\n\n    // Public API for debugging\n    public listThemes(): string[] {\n        return Array.from(this.customThemes.keys());\n    }\n\n    public getThemeConfig(themeName: string): ThemeConfig | undefined {\n        return this.customThemes.get(themeName);\n    }\n}\n\n// =============================================================================\n// Design Tokens Middleware Implementation\n// =============================================================================\n\nexport class DesignTokensMiddleware implements FynAppMiddleware {\n    public readonly name = \"design-tokens\";\n\n    private designTokens: DesignTokens;\n    private fynAppConfigs = new WeakMap<FynApp, DesignTokensMiddlewareConfig>();\n\n    constructor() {\n        this.designTokens = new DesignTokens();\n    }\n\n    async setup(context: FynAppMiddlewareCallContext): Promise<{ status: string }> {\n        const { fynApp, meta } = context;\n        const config = this.validateConfig(meta.config);\n\n        this.fynAppConfigs.set(fynApp, config);\n\n        console.debug(`🎨 Design Tokens Middleware setup for ${fynApp.name}`);\n        return { status: \"ready\" };\n    }\n\n    async apply(context: FynAppMiddlewareCallContext): Promise<void> {\n        const { fynApp, runtime } = context;\n        const config = this.fynAppConfigs.get(fynApp)!;\n\n        // Set up theme if specified\n        if (config.theme) {\n            if (typeof config.theme === 'string') {\n                this.designTokens.setTheme(config.theme);\n            } else {\n                this.designTokens.registerTheme(config.theme);\n                this.designTokens.setTheme(config.theme.name);\n            }\n        }\n\n        // Inject CSS custom properties if enabled\n        if (config.cssCustomProperties !== false) {\n            if (config.isComponentLibrary) {\n                // For component libraries, inject CSS that works for both own scope and importing apps\n                this.designTokens.injectCSSForComponentLibrary(\n                    fynApp.name,\n                    config.cssVariablePrefix || 'fynmesh'\n                );\n            } else {\n                this.designTokens.injectCSSCustomProperties(\n                    fynApp.name,\n                    config.cssVariablePrefix || 'fynmesh',\n                    config.global || false\n                );\n            }\n        }\n\n        // Create API for this FynApp\n        const api = this.createDesignTokensAPI(fynApp, config);\n\n        // Store design tokens instance and API in middleware context\n        runtime.middlewareContext.set(this.name, {\n            designTokens: this.designTokens,\n            api,\n            tokens: this.designTokens.getTokens(),\n            theme: this.designTokens.getTheme(),\n        });\n\n        // Expose global API\n        this.exposeGlobalAPI(fynApp, api);\n\n        console.debug(`✅ Design Tokens Middleware applied to ${fynApp.name}`);\n    }\n\n    private validateConfig(config: any): DesignTokensMiddlewareConfig {\n        return {\n            theme: config?.theme || 'fynmesh-default',\n            customTokens: config?.customTokens || {},\n            cssCustomProperties: config?.cssCustomProperties !== false,\n            cssVariablePrefix: config?.cssVariablePrefix || 'fynmesh',\n            enableThemeSwitching: config?.enableThemeSwitching !== false,\n            persistTheme: config?.persistTheme !== false,\n            storageKey: config?.storageKey || 'fynmesh-theme',\n            global: config?.global || false,\n            isComponentLibrary: config?.isComponentLibrary || false,\n        };\n    }\n\n    private createDesignTokensAPI(fynApp: FynApp, config: DesignTokensMiddlewareConfig): DesignTokensAPI {\n        return {\n            getTokens: () => this.designTokens.getTokens(fynApp.name),\n            getTheme: () => this.designTokens.getTheme(fynApp.name),\n            setTheme: (theme: string, applyGlobally: boolean = true) => this.designTokens.setTheme(theme, fynApp.name, applyGlobally),\n            getCSSVariable: (tokenPath: string) => {\n                const prefix = config.cssVariablePrefix || 'fynmesh';\n                return this.designTokens.getCSSVariable(tokenPath, prefix);\n            },\n            subscribeToThemeChanges: (callback: (theme: string, tokens: DesignTokensData, fynAppName?: string) => void) => {\n                return this.designTokens.subscribeToThemeChanges(callback);\n            },\n            injectCustomCSS: (css: string) => {\n                const styleId = `fynmesh-custom-css-${fynApp.name}`;\n                this.designTokens.injectCustomCSS(css, styleId);\n            },\n            setGlobalOptIn: (optIn: boolean) => this.designTokens.setGlobalOptIn(fynApp.name, optIn),\n            getGlobalOptIn: () => this.designTokens.getGlobalOptIn(fynApp.name),\n        };\n    }\n\n    private exposeGlobalAPI(fynApp: FynApp, api: DesignTokensAPI): void {\n        // Expose API globally for easy access\n        if (typeof window !== 'undefined') {\n            (window as any).fynMeshDesignTokens = api;\n        }\n\n        // Also expose on the FynApp object\n        (fynApp as any).designTokens = api;\n    }\n}\n\n// Export the middleware instance\nexport const __middleware__DesignTokens = new DesignTokensMiddleware();\n\n// Simple main that just loads the middleware\nexport const main = useMiddleware(\n    {\n        info: {\n            name: \"design-tokens\",\n            provider: \"fynapp-design-tokens\",\n            version: \"^1.0.0\",\n        },\n        config: {\n            theme: \"fynmesh-default\",\n            cssCustomProperties: true,\n            cssVariablePrefix: \"fynmesh\",\n        },\n    },\n    noOpMiddlewareUser,\n);\n"],"names":["useMiddleware","meta","user","__middlewareMeta","concat","noOpMiddlewareUser","initialize","execute","info","name","version","provider","config","theme","defaultTokens","colors","primary","secondary","success","warning","danger","light","dark","fynapp1","fynapp1b","fynapp2","fynapp3","fynapp4","fynapp5","fynapp6","fynapp7","spacing","xs","sm","md","lg","xl","typography","sizes","base","weights","thin","normal","medium","semibold","bold","extrabold","black","families","sans","serif","mono","shadows","inner","none","borders","radius","full","width","breakpoints","predefinedThemes","tokens","cssCustomProperties","cssVariablePrefix","DesignTokens","constructor","this","globalTheme","perFynAppThemes","Map","globalOptIns","customThemes","themeChangeSubscribers","Set","styleElements","fynAppConfigs","Object","entries","forEach","key","set","loadPersistedTheme","getTokens","fynAppName","themeToUse","has","get","getTheme","setTheme","themeName","applyGlobally","appsToUpdate","optedIn","appName","delete","push","updateFynAppCSSCustomProperties","callback","error","console","persistTheme","debug","warn","Array","from","keys","registerTheme","setGlobalOptIn","optIn","persistGlobalOptIns","getGlobalOptIn","getCSSVariable","tokenPath","prefix","subscribeToThemeChanges","add","injectCustomCSS","css","id","styleElement","document","getElementById","createElement","head","appendChild","textContent","injectCSSCustomProperties","isGlobal","scope","generateCSSCustomProperties","styleId","isComponentLibrary","injectCSSForComponentLibrary","ownScope","importingAppScope","join","lines","value","updateAllCSSCustomProperties","replace","window","localStorage","saved","getItem","perAppThemes","parsed","JSON","parse","setItem","fromEntries","stringify","listThemes","getThemeConfig","exports","DesignTokensMiddleware","WeakMap","designTokens","setup","context","fynApp","validateConfig","status","apply","runtime","global","api","createDesignTokensAPI","middlewareContext","exposeGlobalAPI","customTokens","enableThemeSwitching","storageKey","fynMeshDesignTokens"],"mappings":"uMAQO,MAAMA,EAAgB,CAACC,EAAMC,KAChCA,EAAKC,iBAAmB,GAAGC,OAAOH,GAC3BC,GAEEG,EAAqB,CAC9BC,WAAY,OACZC,QAAS,QAGOP,EAAc,CAC9BQ,KAAM,CACFC,KAAM,gBACNC,QAAS,SACTC,SAAU,oBAEdC,OAAQ,CAAEC,MAAO,UAClBR,GCXH,MAAMS,EAAkC,CACpCC,OAAQ,CACJC,QAAS,UACTC,UAAW,UACXC,QAAS,UACTC,QAAS,UACTC,OAAQ,UACRZ,KAAM,UACNa,MAAO,UACPC,KAAM,UAENC,QAAS,UACTC,SAAU,UACVC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,WAEbC,QAAS,CACLC,GAAI,UACJC,GAAI,SACJC,GAAI,OACJC,GAAI,SACJC,GAAI,OACJ,MAAO,SACP,MAAO,QAEXC,WAAY,CACRC,MAAO,CACHN,GAAI,UACJC,GAAI,WACJM,KAAM,OACNJ,GAAI,WACJC,GAAI,UACJ,MAAO,SACP,MAAO,WACP,MAAO,UACP,MAAO,OACP,MAAO,WAEXI,QAAS,CACLC,KAAM,IACNpB,MAAO,IACPqB,OAAQ,IACRC,OAAQ,IACRC,SAAU,IACVC,KAAM,IACNC,UAAW,IACXC,MAAO,KAEXC,SAAU,CACNC,KAAM,oIACNC,MAAO,8DACPC,KAAM,2FAGdC,QAAS,CACLnB,GAAI,gCACJC,GAAI,mEACJC,GAAI,qEACJC,GAAI,sEACJ,MAAO,sCACPiB,MAAO,sCACPC,KAAM,aAEVC,QAAS,CACLC,OAAQ,CACJF,KAAM,MACNrB,GAAI,WACJC,GAAI,WACJC,GAAI,SACJC,GAAI,UACJ,MAAO,OACP,MAAO,SACPqB,KAAM,UAEVC,MAAO,CACH,EAAG,MACH,EAAG,MACH,EAAG,MACH,EAAG,MACH,EAAG,QAGXC,YAAa,CACT1B,GAAI,QACJC,GAAI,QACJC,GAAI,SACJC,GAAI,SACJ,MAAO,WAITwB,EAAgD,CAClD,kBAAmB,CACfnD,KAAM,kBACNoD,OAAQ/C,EACRgD,qBAAqB,EACrBC,kBAAmB,WAEvB,eAAgB,CACZtD,KAAM,eACNoD,OAAQ,IACD/C,EACHC,OAAQ,IACDD,EAAcC,OACjBC,QAAS,UACTC,UAAW,UACXC,QAAS,UACTC,QAAS,UACTC,OAAQ,UACRZ,KAAM,UACNa,MAAO,UACPC,KAAM,UACNC,QAAS,UACTC,SAAU,UACVC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,YAGjBgC,qBAAqB,EACrBC,kBAAmB,WAEvB,eAAgB,CACZtD,KAAM,eACNoD,OAAQ,IACD/C,EACHC,OAAQ,IACDD,EAAcC,OACjBC,QAAS,UACTC,UAAW,UACXC,QAAS,UACTC,QAAS,UACTC,OAAQ,UACRZ,KAAM,UACNa,MAAO,UACPC,KAAM,UACNC,QAAS,UACTC,SAAU,UACVC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,YAGjBgC,qBAAqB,EACrBC,kBAAmB,WAEvB,gBAAiB,CACbtD,KAAM,gBACNoD,OAAQ,IACD/C,EACHC,OAAQ,IACDD,EAAcC,OACjBC,QAAS,UACTC,UAAW,UACXC,QAAS,UACTC,QAAS,UACTC,OAAQ,UACRZ,KAAM,UACNa,MAAO,UACPC,KAAM,UACNC,QAAS,UACTC,SAAU,UACVC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,YAGjBgC,qBAAqB,EACrBC,kBAAmB,WAEvB,iBAAkB,CACdtD,KAAM,iBACNoD,OAAQ,IACD/C,EACHC,OAAQ,IACDD,EAAcC,OACjBC,QAAS,UACTC,UAAW,UACXC,QAAS,UACTC,QAAS,UACTC,OAAQ,UACRZ,KAAM,UACNa,MAAO,UACPC,KAAM,UACNC,QAAS,UACTC,SAAU,UACVC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,YAGjBgC,qBAAqB,EACrBC,kBAAmB,WAEvB,iBAAkB,CACdtD,KAAM,iBACNoD,OAAQ,IACD/C,EACHC,OAAQ,IACDD,EAAcC,OACjBC,QAAS,UACTC,UAAW,UACXC,QAAS,UACTC,QAAS,UACTC,OAAQ,UACRZ,KAAM,UACNa,MAAO,UACPC,KAAM,UACNC,QAAS,UACTC,SAAU,UACVC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,YAGjBgC,qBAAqB,EACrBC,kBAAmB,WAEvB,oBAAqB,CACjBtD,KAAM,oBACNoD,OAAQ,IACD/C,EACHC,OAAQ,IACDD,EAAcC,OACjBC,QAAS,UACTC,UAAW,UACXC,QAAS,UACTC,QAAS,UACTC,OAAQ,UACRZ,KAAM,UACNa,MAAO,UACPC,KAAM,UACNC,QAAS,UACTC,SAAU,UACVC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,YAGjBgC,qBAAqB,EACrBC,kBAAmB,kBAQdC,EAST,WAAAC,GARQC,KAAAC,YAAsB,kBACtBD,KAAAE,gBAAkB,IAAIC,IACtBH,KAAAI,aAAe,IAAID,IACnBH,KAAAK,aAAe,IAAIF,IACnBH,KAAAM,uBAAyB,IAAIC,IAC7BP,KAAAQ,cAAgB,IAAIL,IACpBH,KAAAS,cAAgB,IAAIN,IAIxBO,OAAOC,QAAQjB,GAAkBkB,QAAQ,EAAEC,EAAKlE,MAC5CqD,KAAKK,aAAaS,IAAID,EAAKlE,KAI/BqD,KAAKe,oBACT,CAEO,SAAAC,CAAUC,GACb,MAAMC,EAAaD,GAAcjB,KAAKE,gBAAgBiB,IAAIF,GACpDjB,KAAKE,gBAAgBkB,IAAIH,GACzBjB,KAAKC,YACLtD,EAAQqD,KAAKK,aAAae,IAAIF,GACpC,OAAOvE,GAAOgD,QAAU/C,CAC5B,CAEO,QAAAyE,CAASJ,GACZ,OAAIA,EAEIjB,KAAKE,gBAAgBiB,IAAIF,GAClBjB,KAAKE,gBAAgBkB,IAAIH,IAGhCjB,KAAKI,aAAagB,IAAIH,GACfjB,KAAKC,aAKbD,KAAKC,WAChB,CAEO,QAAAqB,CAASC,EAAmBN,EAAqBO,GAAyB,GAC7E,GAAKxB,KAAKK,aAAac,IAAII,GAA3B,CAKA,GAAIC,IAAkBP,EAAY,CAE9BjB,KAAKC,YAAcsB,EAGnB,MAAME,EAAyB,GAC/BzB,KAAKI,aAAaQ,QAAQ,CAACc,EAASC,KAC5BD,IACA1B,KAAKE,gBAAgB0B,OAAOD,GAC5BF,EAAaI,KAAKF,MAK1BF,EAAab,QAAQe,GAAW3B,KAAK8B,gCAAgCH,IAGrEF,EAAab,QAAQe,IACjB,MAAMhC,EAASK,KAAKgB,UAAUW,GAC9B3B,KAAKM,uBAAuBM,QAAQmB,IAChC,IACIA,EAASR,EAAW5B,EACxB,CAAE,MAAOqC,GACLC,QAAQD,MAAM,kCAAmCA,EACrD,KAGZ,KAAO,CAEHhC,KAAKE,gBAAgBY,IAAIG,EAAYM,GACrCvB,KAAK8B,gCAAgCb,GAGrC,MAAMtB,EAASK,KAAKgB,UAAUC,GAC9BjB,KAAKM,uBAAuBM,QAAQmB,IAChC,IACIA,EAASR,EAAW5B,EAAQsB,EAChC,CAAE,MAAOe,GACLC,QAAQD,MAAM,kCAAmCA,EACrD,GAER,CAGAhC,KAAKkC,eAELD,QAAQE,MAAM,wBAAwBZ,IAAYN,IAAeO,EAAgB,QAAQP,IAAe,cAhDxG,MAFIgB,QAAQG,KAAK,aAAab,kCAA2Cc,MAAMC,KAAKtC,KAAKK,aAAakC,QAmD1G,CAEO,aAAAC,CAAc7F,GACjBqD,KAAKK,aAAaS,IAAInE,EAAMJ,KAAMI,GAClCsF,QAAQE,MAAM,wBAAwBxF,EAAMJ,OAChD,CAEO,cAAAkG,CAAexB,EAAoByB,GACtC1C,KAAKI,aAAaU,IAAIG,EAAYyB,GAClC1C,KAAK2C,sBACLV,QAAQE,MAAM,MAAMlB,KAAcyB,EAAQ,aAAe,sCAC7D,CAEO,cAAAE,CAAe3B,GAClB,OAAOjB,KAAKI,aAAagB,IAAIH,KAAe,CAChD,CAEO,cAAA4B,CAAeC,EAAmBC,EAAiB,WACtD,MAAO,SAASA,KAAUD,IAC9B,CAEO,uBAAAE,CAAwBjB,GAE3B,OADA/B,KAAKM,uBAAuB2C,IAAIlB,GACzB,IAAM/B,KAAKM,uBAAuBsB,OAAOG,EACpD,CAEO,eAAAmB,CAAgBC,EAAaC,GAChC,IAAIC,EAAeC,SAASC,eAAeH,GAEtCC,IACDA,EAAeC,SAASE,cAAc,SACtCH,EAAaD,GAAKA,EAClBE,SAASG,KAAKC,YAAYL,IAG9BA,EAAaM,YAAcR,CAC/B,CAEO,yBAAAS,CAA0B3C,EAAoB8B,EAAiB,UAAWc,GAAoB,GACjG,MAAMlE,EAASK,KAAKgB,YACd8C,EAAQD,EAAW,QAAU,IAAI5C,IACjCkC,EAAMnD,KAAK+D,4BAA4BpE,EAAQoD,EAAQe,GAEvDE,EAAU,yBAAyB/C,IACzC,IAAIoC,EAAeC,SAASC,eAAeS,GAEtCX,IACDA,EAAeC,SAASE,cAAc,SACtCH,EAAaD,GAAKY,EAClBV,SAASG,KAAKC,YAAYL,GAC1BrD,KAAKQ,cAAcM,IAAIkD,EAASX,IAGpCA,EAAaM,YAAcR,EAG3BnD,KAAKS,cAAcK,IAAIG,EAAY,CAAE8B,SAAQc,WAAUI,oBAAoB,GAC/E,CAEO,4BAAAC,CAA6BjD,EAAoB8B,EAAiB,WACrE,MAAMpD,EAASK,KAAKgB,YAEdmD,EAAW,IAAIlD,IACfmD,EAAoB,4BAA4BnD,MAEhDkC,EAAM,CACRnD,KAAK+D,4BAA4BpE,EAAQoD,EAAQoB,GACjDnE,KAAK+D,4BAA4BpE,EAAQoD,EAAQqB,IACnDC,KAAK,QAEDL,EAAU,yBAAyB/C,IACzC,IAAIoC,EAAeC,SAASC,eAAeS,GAEtCX,IACDA,EAAeC,SAASE,cAAc,SACtCH,EAAaD,GAAKY,EAClBV,SAASG,KAAKC,YAAYL,GAC1BrD,KAAKQ,cAAcM,IAAIkD,EAASX,IAGpCA,EAAaM,YAAcR,EAG3BnD,KAAKS,cAAcK,IAAIG,EAAY,CAAE8B,SAAQc,UAAU,EAAOI,oBAAoB,GACtF,CAEQ,2BAAAF,CAA4BpE,EAA0BoD,EAAgBe,EAAgB,SAC1F,MAAMQ,EAAkB,CAAC,GAAGR,OA8C5B,OA3CApD,OAAOC,QAAQhB,EAAO9C,QAAQ+D,QAAQ,EAAEC,EAAK0D,MACzCD,EAAMzC,KAAK,OAAOkB,WAAgBlC,MAAQ0D,QAI9C7D,OAAOC,QAAQhB,EAAO9B,SAAS+C,QAAQ,EAAEC,EAAK0D,MAC1CD,EAAMzC,KAAK,OAAOkB,aAAkBlC,MAAQ0D,QAIhD7D,OAAOC,QAAQhB,EAAOxB,WAAWC,OAAOwC,QAAQ,EAAEC,EAAK0D,MACnDD,EAAMzC,KAAK,OAAOkB,UAAelC,MAAQ0D,QAG7C7D,OAAOC,QAAQhB,EAAOxB,WAAWG,SAASsC,QAAQ,EAAEC,EAAK0D,MACrDD,EAAMzC,KAAK,OAAOkB,iBAAsBlC,MAAQ0D,QAGpD7D,OAAOC,QAAQhB,EAAOxB,WAAWW,UAAU8B,QAAQ,EAAEC,EAAK0D,MACtDD,EAAMzC,KAAK,OAAOkB,iBAAsBlC,MAAQ0D,QAIpD7D,OAAOC,QAAQhB,EAAOT,SAAS0B,QAAQ,EAAEC,EAAK0D,MAC1CD,EAAMzC,KAAK,OAAOkB,YAAiBlC,MAAQ0D,QAI/C7D,OAAOC,QAAQhB,EAAON,QAAQC,QAAQsB,QAAQ,EAAEC,EAAK0D,MACjDD,EAAMzC,KAAK,OAAOkB,YAAiBlC,MAAQ0D,QAG/C7D,OAAOC,QAAQhB,EAAON,QAAQG,OAAOoB,QAAQ,EAAEC,EAAK0D,MAChDD,EAAMzC,KAAK,OAAOkB,YAAiBlC,MAAQ0D,QAI/C7D,OAAOC,QAAQhB,EAAOF,aAAamB,QAAQ,EAAEC,EAAK0D,MAC9CD,EAAMzC,KAAK,OAAOkB,gBAAqBlC,MAAQ0D,QAGnDD,EAAMzC,KAAK,KAEJyC,EAAMD,KAAK,KACtB,CAEQ,4BAAAG,GACJxE,KAAKQ,cAAcI,QAAQ,CAACyC,EAAcW,KACtC,MAAM/C,EAAa+C,EAAQS,QAAQ,yBAA0B,IACvD/H,EAASsD,KAAKS,cAAcW,IAAIH,GAEtC,GAAIvE,EAAQ,CACR,MAAMiD,EAASK,KAAKgB,UAAUC,GACxB6C,EAAQpH,EAAOmH,SAAW,QAAU,IAAI5C,IACxCkC,EAAMnD,KAAK+D,4BAA4BpE,EAAQjD,EAAOqG,OAAQe,GACpET,EAAaM,YAAcR,CAC/B,GAER,CAEQ,+BAAArB,CAAgCb,GACpC,MAAM+C,EAAU,yBAAyB/C,IACnCoC,EAAerD,KAAKQ,cAAcY,IAAI4C,GACtCtH,EAASsD,KAAKS,cAAcW,IAAIH,GAEtC,GAAIoC,GAAgB3G,EAAQ,CACxB,MAAMiD,EAASK,KAAKgB,UAAUC,GAE9B,GAAIvE,EAAOuH,mBAAoB,CAE3B,MAAME,EAAW,IAAIlD,IACfmD,EAAoB,4BAA4BnD,MAEhDkC,EAAM,CACRnD,KAAK+D,4BAA4BpE,EAAQjD,EAAOqG,OAAQoB,GACxDnE,KAAK+D,4BAA4BpE,EAAQjD,EAAOqG,OAAQqB,IAC1DC,KAAK,QAEPhB,EAAaM,YAAcR,CAC/B,KAAO,CAEH,MAAMW,EAAQpH,EAAOmH,SAAW,QAAU,IAAI5C,IACxCkC,EAAMnD,KAAK+D,4BAA4BpE,EAAQjD,EAAOqG,OAAQe,GACpET,EAAaM,YAAcR,CAC/B,CACJ,CACJ,CAEQ,kBAAApC,GACJ,IACI,GAAsB,oBAAX2D,QAA0BA,OAAOC,aAAc,CACtD,MAAMC,EAAQD,aAAaE,QAAQ,iBAC/BD,GAAS5E,KAAKK,aAAac,IAAIyD,KAC/B5E,KAAKC,YAAc2E,GAIvB,MAAME,EAAeH,aAAaE,QAAQ,0BAC1C,GAAIC,EAAc,CACd,MAAMC,EAASC,KAAKC,MAAMH,GAC1BpE,OAAOC,QAAQoE,GAAQnE,QAAQ,EAAEK,EAAYtE,MACpB,iBAAVA,GAAsBqD,KAAKK,aAAac,IAAIxE,IACnDqD,KAAKE,gBAAgBY,IAAIG,EAAYtE,IAGjD,CAGA,MAAMyD,EAAeuE,aAAaE,QAAQ,0BAC1C,GAAIzE,EAAc,CACd,MAAM2E,EAASC,KAAKC,MAAM7E,GAC1BM,OAAOC,QAAQoE,GAAQnE,QAAQ,EAAEK,EAAYyB,MACpB,kBAAVA,GACP1C,KAAKI,aAAaU,IAAIG,EAAYyB,IAG9C,CACJ,CACJ,CAAE,MAAOV,GACLC,QAAQG,KAAK,kCAAmCJ,EACpD,CACJ,CAEQ,YAAAE,GACJ,IACI,GAAsB,oBAAXwC,QAA0BA,OAAOC,aAAc,CACtDA,aAAaO,QAAQ,gBAAiBlF,KAAKC,aAG3C,MAAM6E,EAAepE,OAAOyE,YAAYnF,KAAKE,gBAAgBS,WAC7DgE,aAAaO,QAAQ,yBAA0BF,KAAKI,UAAUN,GAClE,CACJ,CAAE,MAAO9C,GACLC,QAAQG,KAAK,2BAA4BJ,EAC7C,CACJ,CAEQ,mBAAAW,GACJ,IACI,GAAsB,oBAAX+B,QAA0BA,OAAOC,aAAc,CACtD,MAAMvE,EAAeM,OAAOyE,YAAYnF,KAAKI,aAAaO,WAC1DgE,aAAaO,QAAQ,yBAA0BF,KAAKI,UAAUhF,GAClE,CACJ,CAAE,MAAO4B,GACLC,QAAQG,KAAK,oCAAqCJ,EACtD,CACJ,CAGO,UAAAqD,GACH,OAAOhD,MAAMC,KAAKtC,KAAKK,aAAakC,OACxC,CAEO,cAAA+C,CAAe/D,GAClB,OAAOvB,KAAKK,aAAae,IAAIG,EACjC,EACHgE,EAAA,eAAAzF,SAMY0F,EAMT,WAAAzF,GALgBC,KAAAzD,KAAO,gBAGfyD,KAAAS,cAAgB,IAAIgF,QAGxBzF,KAAK0F,aAAe,IAAI5F,CAC5B,CAEA,WAAM6F,CAAMC,GACR,MAAMC,OAAEA,EAAM9J,KAAEA,GAAS6J,EACnBlJ,EAASsD,KAAK8F,eAAe/J,EAAKW,QAKxC,OAHAsD,KAAKS,cAAcK,IAAI+E,EAAQnJ,GAE/BuF,QAAQE,MAAM,yCAAyC0D,EAAOtJ,QACvD,CAAEwJ,OAAQ,QACrB,CAEA,WAAMC,CAAMJ,GACR,MAAMC,OAAEA,EAAMI,QAAEA,GAAYL,EACtBlJ,EAASsD,KAAKS,cAAcW,IAAIyE,GAGlCnJ,EAAOC,QACqB,iBAAjBD,EAAOC,MACdqD,KAAK0F,aAAapE,SAAS5E,EAAOC,QAElCqD,KAAK0F,aAAalD,cAAc9F,EAAOC,OACvCqD,KAAK0F,aAAapE,SAAS5E,EAAOC,MAAMJ,SAKb,IAA/BG,EAAOkD,sBACHlD,EAAOuH,mBAEPjE,KAAK0F,aAAaxB,6BACd2B,EAAOtJ,KACPG,EAAOmD,mBAAqB,WAGhCG,KAAK0F,aAAa9B,0BACdiC,EAAOtJ,KACPG,EAAOmD,mBAAqB,UAC5BnD,EAAOwJ,SAAU,IAM7B,MAAMC,EAAMnG,KAAKoG,sBAAsBP,EAAQnJ,GAG/CuJ,EAAQI,kBAAkBvF,IAAId,KAAKzD,KAAM,CACrCmJ,aAAc1F,KAAK0F,aACnBS,MACAxG,OAAQK,KAAK0F,aAAa1E,YAC1BrE,MAAOqD,KAAK0F,aAAarE,aAI7BrB,KAAKsG,gBAAgBT,EAAQM,GAE7BlE,QAAQE,MAAM,yCAAyC0D,EAAOtJ,OAClE,CAEQ,cAAAuJ,CAAepJ,GACnB,MAAO,CACHC,MAAOD,GAAQC,OAAS,kBACxB4J,aAAc7J,GAAQ6J,cAAgB,CAAA,EACtC3G,qBAAqD,IAAhClD,GAAQkD,oBAC7BC,kBAAmBnD,GAAQmD,mBAAqB,UAChD2G,sBAAuD,IAAjC9J,GAAQ8J,qBAC9BtE,cAAuC,IAAzBxF,GAAQwF,aACtBuE,WAAY/J,GAAQ+J,YAAc,gBAClCP,OAAQxJ,GAAQwJ,SAAU,EAC1BjC,mBAAoBvH,GAAQuH,qBAAsB,EAE1D,CAEQ,qBAAAmC,CAAsBP,EAAgBnJ,GAC1C,MAAO,CACHsE,UAAW,IAAMhB,KAAK0F,aAAa1E,UAAU6E,EAAOtJ,MACpD8E,SAAU,IAAMrB,KAAK0F,aAAarE,SAASwE,EAAOtJ,MAClD+E,SAAU,CAAC3E,EAAe6E,GAAyB,IAASxB,KAAK0F,aAAapE,SAAS3E,EAAOkJ,EAAOtJ,KAAMiF,GAC3GqB,eAAiBC,IACb,MAAMC,EAASrG,EAAOmD,mBAAqB,UAC3C,OAAOG,KAAK0F,aAAa7C,eAAeC,EAAWC,IAEvDC,wBAA0BjB,GACf/B,KAAK0F,aAAa1C,wBAAwBjB,GAErDmB,gBAAkBC,IACd,MAAMa,EAAU,sBAAsB6B,EAAOtJ,OAC7CyD,KAAK0F,aAAaxC,gBAAgBC,EAAKa,IAE3CvB,eAAiBC,GAAmB1C,KAAK0F,aAAajD,eAAeoD,EAAOtJ,KAAMmG,GAClFE,eAAgB,IAAM5C,KAAK0F,aAAa9C,eAAeiD,EAAOtJ,MAEtE,CAEQ,eAAA+J,CAAgBT,EAAgBM,GAEd,oBAAXzB,SACNA,OAAegC,oBAAsBP,GAIzCN,EAAeH,aAAeS,CACnC,EACHZ,EAAA,yBAAAC,GAGsCD,EAAA,6BAAG,IAAIC,GAG7BD,EAAA,OAAGzJ,EAChB,CACIQ,KAAM,CACFC,KAAM,gBACNE,SAAU,uBACVD,QAAS,UAEbE,OAAQ,CACJC,MAAO,kBACPiD,qBAAqB,EACrBC,kBAAmB,YAG3B1D","x_google_ignoreList":[0]}